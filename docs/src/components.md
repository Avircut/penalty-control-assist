# Основные компоненты

## Главный модуль (main.py)

`main.py` - это точка входа в приложение. Он инициализирует Eel, настраивает веб-интерфейс и содержит основные функции для работы с изображениями и управления состоянием игры.

### Основные функции:
- `recognize_cells(image)`: Анализирует изображение для определения ячеек с результатами ударов
- `screen_capture()`: Захватывает изображение с экрана и передает его на анализ
- `check_screen(image)`: Проверяет изображение на наличие новых результатов и обновляет состояние игры
- `start_series()`: Начинает новую серию матчей
- `stop_series()`: Останавливает текущую серию матчей
- `series_control()`: Управляет серией матчей
- `start_match()`: Начинает новый матч
- `manually_set_match_state(state)`: Устанавливает состояние матча вручную
- `get_state()`: Возвращает текущее состояние игры для отображения в интерфейсе
- `turn_mode(value, state)`: Переключает режим между автоматическим и ручным

## Контроллер игры (game_controller.py)

`game_controller.py` содержит класс `GameController`, который управляет состоянием игры. Он хранит информацию о текущей серии матчей, игроках, счете и результатах ударов.

### Основные методы:
- `start_series(player_names)`: Начинает новую серию матчей
- `start_match()`: Начинает новый матч
- `commit_result(result, player_index)`: Записывает результат удара
- `check_game_end(max_kicks)`: Проверяет, закончился ли матч
- `finish_match(match_result)`: Завершает матч
- `finish_series()`: Завершает серию матчей
- `set_status(status)`: Устанавливает статусное сообщение

## Утилиты

### cfg_utils.py
Содержит функции для работы с конфигурацией:
- `load_config()`: Загружает конфигурацию из файла
- `save_config(data)`: Сохраняет конфигурацию в файл
- `get_config()`: Возвращает текущую конфигурацию

### path_utils.py
Содержит функции для работы с путями:
- `resource_path(relative_path)`: Возвращает путь к ресурсу (работает как в исходном коде, так и в скомпилированном приложении)
- `get_executable_path(file_name)`: Возвращает путь к файлу относительно исполняемого файла

### log_settings.py
Настраивает логирование:
- Создает логгер с двумя обработчиками: для отладочных сообщений и для информационных сообщений
- Предоставляет функцию `open_history()` для открытия файла с логами

### utils.py
Содержит различные утилиты:
- Функции для обработки изображений (`thresholding`, `convert_contours_to_bboxes`, `sort_bboxes`, `cell_check`)
- Функции для работы с Excel (`clear_table`, `write_to_cell`, `write_to_excel`, `check_table_structure`)
- Функции для работы с UI (`show_message`, `get_windows`, `get_monitors`)
- Функции для работы с игрой (`calculate_score`, `extract_teams`, `get_teams`)

## Пользовательский интерфейс

Интерфейс приложения построен с использованием HTML, CSS и JavaScript. Основной файл интерфейса - `ui/main.html`.

### Основные компоненты интерфейса:
- Настройки (выбор файла, окна vMix, монитора, настройки серии)
- Отображение текущего матча (команды, результаты ударов)
- Переключатель режима (автоматический/ручной)
- Кнопки управления (начать серию, закончить серию, история матчей)
- Статусное сообщение

### Взаимодействие с бэкендом:
Взаимодействие между фронтендом и бэкендом осуществляется с помощью библиотеки Eel. Функции Python, помеченные декоратором `@eel.expose`, доступны в JavaScript:

```javascript
// Пример вызова Python-функции из JavaScript
const state = await eel.get_state()();
```
